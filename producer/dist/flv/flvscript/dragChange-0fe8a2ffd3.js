"use strict";var correctDrag=function(m,e,n,W){function s(e){return(e=Math.round(e))%2==1&&e++,e}function O(){var e=window.innerWidth*(100/1920);m("html").css("font-size",e+"px");for(var t=m(".big-video"),i=0;i<t.length;i++){var r=t.eq(i);r.css("height",9*r.width()/16+"px")}}return O(),{textBlur:function(e){var t=e.scaleClassName,i=m(t),r=m(t).css("transform");if("none"!=r){r=r.substring(7,r.indexOf(","));var p=parseInt(i.css("font-size"))*r;12<p?m(t).css({transform:"scale(1)","font-size":p+"px"}):(r=p/12,m(t).css({transform:"scale("+r+")","font-size":p+"px"}))}var o=overlayCut.subtitleCom();o.style=JSON.stringify(o.style),o.id=o.textId,o.checked=1,n.textInit(o,!0),m(".textDiv").css({width:i.width()+"px",height:i.height()+"px"})},correctLogo:function(e){var t=e.target,i=(e.rate,{}),r=m(t).width(),p=(m(t).height(),m(t).position().left),o=m(t).position().top,a=m("#preview").width()-p-r;i.logoXOffset=W.getOutputWidth("#preview",a),i.logoYOffset=W.getOutputHeight("#preview",o),i.imageWidth=W.getOutputWidth("#preview",r),i.imageHeight=Math.round(i.imageWidth*e.rate),i.id=m(t).attr("data-id"),i.logoXOffset=s(i.logoXOffset),i.logoYOffset=s(i.logoYOffset),i.imageWidth=s(i.imageWidth),i.imageHeight=Math.round(i.imageWidth*e.rate),m(t).css({width:W.getPriviewWidth("#preview",null,i.imageWidth)+"px",height:W.getPriviewWidth("#preview",null,i.imageWidth*e.rate)+"px",top:W.getPriviewHeight("#preview",null,i.logoYOffset)+"px"}),m(t).css({left:W.getPriviewWidth("#preview",null,W.resolutionW-i.logoXOffset-i.imageWidth)+"px"}),i.url=m(t).attr("data-url"),i.zorder=3,i.checkedStatus=1,n.logoInit(i,!0)},correctPip:function(e){var t=e.target,i=(e.rate,{}),r=m(t).width(),p=m(t).position().left,o=m(t).position().top,a=m("#preview").width()-p-r;a=W.getOutputWidth("#preview",a),r=W.getOutputHeight("#preview",r),o=W.getOutputWidth("#preview",o),(i={}).pipXOffset=s(a),i.pipWidth=s(r),i.pipYOffset=s(o),i.pipHeight=Math.round(i.pipWidth*e.rate),i.id=m(".pretreat-content .pip").attr("data-id"),i.pipAudioSharedMemoryName=m(".pretreat-content .pip").attr("data-pipaudiosharedmemoryname"),i.pipVideoSharedMemoryName=m(".pretreat-content .pip").attr("data-pipvideosharedmemoryname"),i.zorder=1,i.checkedStatus=1,m(t).css({width:W.getPriviewWidth("#preview",null,i.pipWidth)+"px",height:W.getPriviewWidth("#preview",null,i.pipWidth*e.rate)+"px",top:W.getPriviewHeight("#preview",null,i.pipYOffset)+"px"}),m(t).css({left:W.getPriviewWidth("#preview",null,W.resolutionW-i.pipXOffset-i.pipWidth)+"px"}),n.pipInit(i)},dragCorrectPositionAndSize:function(){O(),document.body.clientWidth,m(".main-preview .preview-source").width(),W.resolutionW,816<m("#preview").width()&&m(".score-pattern ul").css("left","0");var e=m(".pretreat-content .pretreat-item-score.check");if(0!==e.length){var t=e.attr("data-params");if(t=decodeURIComponent(t),null==(t=JSON.parse(t)).imageWidth){var i=t.size.split("x");t.imageWidth=i[0],t.imageHeight=i[1]}var r=W.getPriviewWidth("#preview",null,t.imageWidth),p=W.getPriviewHeight("#preview",null,t.imageHeight),o=W.getPriviewWidth("#preview",null,t.logoXOffset),a=W.getPriviewHeight("#preview",null,t.logoYOffset),s=m("#preview").width()-o-r;m(".preview-source .scoreDiv").removeAttr("style"),m(".preview-source .scoreDiv").css({position:"absolute",width:r+"px",height:p+"px",left:s+"px",top:a+"px","z-index":"5"})}var n=m(".pretreat-content .logo.check");0!==n.length&&(n.trigger("click"),n.trigger("click"));var h=m(".pretreat-content .pretreat-item-text.check");if(0!==h.length){t=h.attr("data-params"),t=decodeURIComponent(t),t=JSON.parse(t),o=W.getPriviewWidth("#preview",null,t.xOffset),a=W.getPriviewHeight("#preview",null,t.yOffset);var d=JSON.parse(t.style),g=W.getPriviewHeight("#preview",null,d.fontSize),l=d.backgroundColor.slice(2,8),v=d.backgroundColor.slice(0,2),c=HexToRgba(l,v),w=d.foregroundColor.slice(2,8);m("#preview .textDiv").removeAttr("style"),m("#preview .textDiv").css({position:"absolute",right:o+"px",top:a+"px","z-index":"3"}),m("#preview .textDiv .preTextarea").css("font-size",g+"px");var f=m("#preview").width()-o-m(".textDiv").width();m("#preview .textDiv").removeAttr("style"),m("#preview .textDiv").css({position:"absolute",left:f+"px",top:a+"px","z-index":"3"}),m("#preview .textDiv").css("background-color",c),m("#preview .textDiv .preTextarea").css("color","#"+w)}if(0!=m("#preview .pip").length){t={pipXOffset:"",pipYOffset:"",pipWidth:"",pipHeight:""},t=getAttrs(m(".pretreat-content .pip"),t);var u=W.getPriviewWidth("#preview",null,t.pipWidth),x=W.getPriviewHeight("#preview",null,t.pipHeight);o=W.getPriviewWidth("#preview",null,t.pipXOffset),a=W.getPriviewHeight("#preview",null,t.pipYOffset),m("#preview .pip").removeAttr("style"),m("#preview .pip").css({width:u+"px",height:x+"px",right:o+"px",top:a+"px","z-index":"2"})}},correctClock:function(e){var t=e.target,i={},r=m(t).width(),p=(m(t).height(),m(t).position().left),o=m(t).position().top,a=m("#preview").width()-p-r;i.xOffset=W.getOutputWidth("#preview",a),i.yOffset=W.getOutputHeight("#preview",o),i.id=m(t).attr("data-id"),i.imageWidth=W.getOutputWidth("#preview",r),i.id=m(t).attr("data-id"),i.zorder=7,i.operation=m(t).attr("data-operation"),i.height="60",i.width="116",i.checked="1","create"!==m(".clockDiv").attr("data-operation")&&m(".clockDiv").attr("data-operation","clockCut");var s={fontName:"Arial",fontSize:46,foregroundColor:"FFFFFFFF",text:m(".clockTextarea").html()};i.style=s,n.clockInit(i,!0)}}}($,oUtils,overlying,widthAndHeight);