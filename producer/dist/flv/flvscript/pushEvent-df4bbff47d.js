"use strict";!function(e,t,a){var i,n=e.getElementsByTagName(t)[0];e.getElementById(a)||((i=e.createElement(t)).id=a,i.src="//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.0",n.parentNode.insertBefore(i,n))}(document,"script","facebook-jssdk");var facebookpushapi={getPosition:function(e){var o=e||"",s=facebookCheckInDistance,r=$("form.pushCount").attr("data-token"),t=$(".preview-content .preview-item[data-filename='Default']").attr("data-rid").toLowerCase(),a=$(".main-preview").attr("data-livepeerid"),i=($("form.pushCount").attr("data-rtmpid"),{rId:t,tId:a});oUtils.ajaxReq("getGeoInfo.action",i,function(e){if("0x0"==e.errorCode){var t=$.parseJSON(e.errorInfo),a=t.latitude,i=t.longitude,n="/search?q="+o+"&type=place&center="+a+","+i+"&distance="+s+"&access_token="+r;FB.api(n,function(e){if(e&&!e.error){var t=e.data,i=[];0<t.length&&($.each(t,function(e,t){var a='<div class="listCommon" data-id="'+t.id+'">'+t.name+"</div>";i.push(a)}),$(".searchList").show(),$(".searchList").html(i.join("")),$(".searchList").fnNiceScroll(),facebookpushapi.createClick())}else oUtils.alertTips("")})}})},getFbFriends:function(){var e=$("form.pushCount").attr("data-token"),t="/"+$("form.pushCount").attr("data-rtmpid")+"/taggable_friends?access_token="+e;FB.api(t,"GET",function(e){if(e&&!e.error){var t=e.data,i=[];0<t.length&&($.each(t,function(e,t){var a='<div class="listCommon" data-id="'+t.id+'">'+t.name+"</div>";i.push(a)}),$(".searchList").html(i.join("")),$(".searchList").fnNiceScroll(),facebookpushapi.createClick())}else oUtils.alertTips("")})},getTag:function(e){var t=e||"tvu",a=$("form.pushCount").attr("data-token");FB.api("/search?type=adinterest&q="+t+"&access_token="+a,function(e){if(e&&!e.error){var t=e.data,i=[];if(0<t.length)$.each(t,function(e,t){var a='<div class="listCommon" data-id="'+t.id+'">'+t.name+"</div>";i.push(a)}),$(".searchList").html(i.join("")),$(".searchList").fnNiceScroll(),0<$(".tagList .Tag").length&&$.each($(".tagList .Tag"),function(e,t){var i=$(t).attr("data-id");$.each($(".searchList .listCommon"),function(e,t){var a=$(t).attr("data-id");i==a?$(t).hide():$(t).show()})}),$(".searchList").show(),facebookpushapi.createClick()}else oUtils.alertTips("")})},showFriendByKeyWord:function(a){var e=$(".searchList .listCommon").length,t=$(".searchList .listCommon"),o=[];0<e&&($.each(t,function(e,i){var n=$(i).html().toLowerCase();if(0<=n.indexOf(a)){var t=$(".friendList .friendTag");$.each(t,function(e,t){var a=$(t).children(".friendSpan").html().toLowerCase();o.push(a),0<=o.indexOf(n)?$(i).hide():$(i).show()}),t.length||$(i).show()}else $(i).hide()}),$(".searchList").show(),""==a&&$(".searchList").hide())},createClick:function(e){$("#detailPush .listCommon").unbind(),$("#detailPush .listCommon").on("click",function(){var e=$(this);$(".keyContent").attr("data-type");$(".searchList").hide(),facebookpushapi.createSelectTag(e)})},createClickKeyWord:function(){$(".keyText .greenFont").unbind(),$(".keyText .greenFont").on("click",function(){if("position"==$(this).attr("data-type")){var e=$("#positionInput").val();this.getPosition(e),$(".searchList").css("top",78),$(".keyContent").css("margin-top",0),$(".fbIcon").css("margin-top",0),$(".positionList").show().siblings().hide(),$("#positionInput").focus(),$(".iconBox").removeClass("active"),$(".iconBox").eq(0).addClass("active"),$(".searchList").css({left:30,width:380}),$(".keyContent").attr("name",switchLangObj.i18n_at).html(switchLangObj.i18n_at).attr("data-type","At")}else{$(".friendList").show().siblings().hide(),$(".iconBox").removeClass("active"),$(".iconBox").eq(1).addClass("active"),"35px"<$(".friendList").css("height")&&($(".searchList").css("top",107),$(".keyContent").css("margin-top",15),$(".fbIcon").css("margin-top",15)),$(".searchList").css({left:42,width:366}),$(".keyContent").attr("name",switchLangObj.i18n_with).html(switchLangObj.i18n_with).attr("data-type","Friends"),this.getFbFriends(),$(".searchList").hide()}})},createSelectTag:function(e){switch($(".keyContent").attr("data-type")){case"At":facebookpushapi.showPositionByKeyWord(e);break;case"Friends":facebookpushapi.createFriendTag(e);break;case"Tag":facebookpushapi.createTag(e)}},showPositionByKeyWord:function(e){var t=e.html(),a=e.attr("data-id"),i='<div class="i18n positionBox-key left" name=""></div><div class="positionBox-text greenFont ellipsis left" data-type="position">'+t+"</div>";$(".positionBox").html(i),$("#positionInput").val(t).attr("data-id",a);var n=0<$(".friendBox .friendMudleBox").length,o=0<t.indexOf(",");n?o?$(".positionBox .positionBox-key").html(switchLangObj.i18n_In_low):$(".positionBox .positionBox-key").html(switchLangObj.i18n_at_low):o?$(".positionBox .positionBox-key").html(switchLangObj.i18n_In):$(".positionBox .positionBox-key").html(switchLangObj.i18n_at_none),$(".keyWord").show(),facebookpushapi.createClickKeyWord()},createFriendTag:function(e){var t=e.html(),a=e.attr("data-id"),i=0<$(".friendList .friendTag").length,n='<span class="friendTag"><span data-id="'+a+'" class="friendSpan ellipsis">'+t+'</span><i class="closeTab iconfont closeIcon"></i></span>',o='<div class="left friendMudleBox"><div class="i18n positionBox-key left" name=""></div><div class="positionBox-text greenFont ellipsis" data-type="friends">'+t+"</div></div>";$(".friendBox").append(o),i?$(".friendTag").last().after(n):$(".friendList").prepend(n),"35px"<$(".friendList").css("height")?($(".searchList").css("top",107),$(".keyContent").css("margin-top",15),$(".fbIcon").css("margin-top",15)):$(".searchList").css("top",78);for(var s=$(".friendList .friendTag").length,r=2;r<s;r++)$(".friendBox .friendMudleBox").eq(r).hide();$(".friendBox .positionBox-key").html(switchLangObj.i18n_with_none),s<3?2==s&&$(".friendBox .friendMudleBox").eq(1).children(".positionBox-key").html(switchLangObj.i18n_andother):($(".friendBox .friendMudleBox").eq(1).hide(),$(".userNumber").html(s-1),$(".togetherKey").show()),$("#fbInput").attr("placeholder","").val(""),$(".keyWord").show(),$(".searchList").hide(),$(".friendList").fnNiceScroll();var d=0<$(".friendBox .friendMudleBox").length;if(!!$(".positionBox .positionBox-text").html())var c=0<$(".positionBox .positionBox-text").html().indexOf(",");d?c?$(".positionBox .positionBox-key").html(switchLangObj.i18n_In_low):$(".positionBox .positionBox-key").html(switchLangObj.i18n_at_low):c?$(".positionBox .positionBox-key").html(switchLangObj.i18n_In):$(".positionBox .positionBox-key").html(switchLangObj.i18n_at_none),facebookpushapi.createClickKeyWord()},createTag:function(e){var t=e.html().toLowerCase(),a='<span class="Tag" data-id="'+e.attr("data-id")+'"><span class="tagSpan ellipsis">'+t+'</span><i class="closeTab iconfont closeIcon"></i></span>';0<$(".tagList .Tag").length?$(".Tag").last().after(a):$(".tagList").prepend(a),"35px"<$(".tagList").css("height")?($(".searchList").css("top",107),$(".keyContent").css("margin-top",15),$(".fbIcon").css("margin-top",15)):($(".searchList").css("top",78),$(".searchList").hide(),$(".tagList").fnNiceScroll()),$("#tagInput").attr("placeholder","").val("")},closeFriend:function(e){e.parent(".friendTag").remove();var t,i=e.siblings(".friendSpan").html();$(".friendList").css("height")<="35px"&&($(".keyContent").css("margin-top",0),$(".fbIcon").css("margin-top",0),$(".searchList").css("top",78));var a=$(".friendBox .friendMudleBox");$.each(a,function(e,t){var a=$(t).children(".positionBox-text").html();i==a&&$(t).remove()}),3<=(t=$(".friendTag").length)?$(".friendBox .friendMudleBox").eq(0).show().children(".positionBox-key").html(switchLangObj.i18n_with):2==t?($(".togetherKey").hide(),$(".friendBox .friendMudleBox").eq(0).show().children(".positionBox-key").html(switchLangObj.i18n_with),$(".friendBox .friendMudleBox").eq(1).show().children(".positionBox-key").html(switchLangObj.i18n_andother)):1==t&&$(".friendBox .friendMudleBox").eq(0).show().children(".positionBox-key").html(switchLangObj.i18n_with),t?$("#fbInput").attr("placeholder","").blur():$("#fbInput").attr("placeholder",switchLangObj.i18n_who).blur(),$(".userNumber").html(t-1);var n=0<$(".friendBox .friendMudleBox").length;if(!!$(".positionBox .positionBox-text").html())var o=0<$(".positionBox .positionBox-text").html().indexOf(",");n||(o?$(".positionBox .positionBox-key").html(switchLangObj.i18n_In):$(".positionBox .positionBox-key").html(switchLangObj.i18n_at_none))},pushFaceBook:function(){var r="";$("form.pushCount").on("click","#fbFunction .iconBox",function(){var e=(new Date).getTime(),t=r;if(!((r=e)-t<1e3)){var a=$(this),i=a.attr("data-type"),n=a.hasClass("active"),o=a.parents("form").attr("data-token");if($("#fbFunction .iconBox").removeClass("active"),$(".searchList").html(""),$(".fb-head").hide(),!o)return $("#detailPush .panda-auth").show(),$("#detailPush .panda-login").show(),$("#detailPush .panda-nickname").hide(),void oUtils.alertTips("i18n_reAuthenticate",2e3);if(n)return $(".fb-head").slideUp().removeClass("border"),void $(".fb-foot-left").hide();switch($(".fb-head").slideDown().addClass("border"),$(".fb-foot-left").show(),a.addClass("active"),$(".searchList").css("top",78),$(".keyContent").css("margin-top",0),$(".fbIcon").css("margin-top",0),$(".positionList,.friendList,.tagList").hide(),$(".keyContent").attr("data-type",i),i){case"At":$(".positionList").show(),facebookpushapi.getPosition(),$("#positionInput").focus(),$(".searchList").css({left:30,width:380}),$(".keyContent").attr("name",switchLangObj.i18n_at).html(switchLangObj.i18n_at),$("#positionInput").attr("placeholder",switchLangObj.i18n_where);break;case"Friends":$(".friendList").show(),facebookpushapi.getFbFriends();var s=$(".friendList .friendTag").length;"35px"<$(".friendList").css("height")&&($(".searchList").css("top",107),$(".keyContent").css("margin-top",15),$(".fbIcon").css("margin-top",15)),$(".searchList").css({left:42,width:366}),$(".keyContent").attr("name",switchLangObj.i18n_with).html(switchLangObj.i18n_with),$("#fbInput").attr("placeholder",switchLangObj.i18n_who),0<s?$("#fbInput").val("").attr("placeholder",""):$("#fbInput").focus();break;case"Tag":$(".tagList").show(),facebookpushapi.getTag();s=$(".tagList .Tag").length;"35px"<$(".tagList").css("height")&&($(".searchList").css("top",107),$(".keyContent").css("margin-top",15),$(".fbIcon").css("margin-top",15)),$(".searchList").css({left:42,width:366}),$(".keyContent").attr("name",switchLangObj.i18n_tag).html(switchLangObj.i18n_tag),$("#tagInput").attr("placeholder",switchLangObj.i18n_videoTag),0<s?$("#tagInput").val("").attr("placeholder",""):$("#tagInput").focus()}}}),$("form.pushCount").on("click",".fb-foot-box .closeTab",function(){var e=$(this);switch($(".keyContent").attr("data-type")){case"Friends":facebookpushapi.closeFriend(e);break;case"Tag":var t=$(".tagList .Tag").length;e.parent(".Tag").remove(),$(".tagList").css("height")<="35px"&&($(".searchList").css("top",78),$(".keyContent").css("margin-top",0),$(".fbIcon").css("margin-top",0)),t?$("#tagInput").attr("placeholder","").blur():$("#tagInput").attr("placeholder",switchLangObj.i18n_videoTag).blur()}}),$("form.pushCount").on("click",".fb-foot-box",function(){switch($(".keyContent").attr("data-type")){case"At":$(".searchList").show(),$("#positionInput").focus();break;case"Friends":$("#fbInput").focus();break;case"Tag":facebookpushapi.getTag(),$("#tagInput").focus()}}),$("form.pushCount").on("click",".pageInfo",function(){var e=$(this).attr("data-id"),t=$(this).attr("data-token");$("#shareTo").attr({pageId:e,pageToken:t}),$(".pageList").hide(),$("#shareTo").attr("data-value","Page"),$("#shareTo .dropdownDefault_value").attr("title","Page").html("Page")}),$("form.pushCount").on("click",".closeInputBox",function(){0==$(".friendBox .friendMudleBox").length?$(".keyWord").hide():$(".keyWord").show(),$(".positionBox").html(""),$(".searchList").hide(),$("#positionInput").val("").attr("placeholder",switchLangObj.i18n_where)})},checkPage:function(){var e=$("#detailPush").attr("data-token"),t=$("#detailPush").attr("data-rtmpid");if(""!=e){var a="/"+t+"/accounts";FB.api(a,"GET",{access_token:e},function(e){0<e.data.length?$("#shareTo").removeClass("disabled"):$("#shareTo").addClass("disabled")})}},updateLiveVideo:function(e,t,a,i,n){var o={access_token:n};null!=t&&(o.place=t),null!=a&&(o.tags=a),null!=i&&(o.content_tags=i),FB.api("/"+e,"POST",o,function(e){facebookpushapi.clearLastData()})},clearLastData:function(){$(".friendList .friendTag").remove(),$(".tagList .Tag").remove(),$(".fb-head").slideUp().removeClass("border"),$(".fb-foot-left").hide(),$("#fbFunction .iconBox").removeClass("active"),$(".keyContent").css("margin-top",0),$(".fbIcon").css("margin-top",0),$(".searchList").css("top",78),$(".keyWord").hide(),$("#positionInput,#fbInput,#tagInput").val(""),$(".friendBox").html(""),$(".positionBox").html(""),$(".togetherKey").hide(),$("#positionInput").attr("data-id","")},getPageId:function(e){if("Page"==e.children().attr("data-value")){var t=$("#detailPush").attr("data-token"),a="/"+$("#detailPush").attr("data-rtmpid")+"/accounts";FB.api(a,"GET",{access_token:t},function(e){if(console.log(e),e&&!e.error){$(".pageList").show();var i=[];$.each(e.data,function(e,t){var a='<div class="pageInfo" data-id="'+t.id+'" data-token="'+t.access_token+'">'+t.name+"</div>";i.push(a)}),$(".pageList").html(i.join("")),$(".pageList").fnNiceScroll()}})}else $(".pageList").hide()}},pushAbout=function(f,l,m,o,c,u){var p={ancestorparent:".previewModule-control",parentDom:".share2Platform",pushBtnDom:" .publish",pushDetailDom:"#detailPush",addExtSourceType:"#addExtSource_sourceTypeList",addExtSource:"#addShareSource",pushCount:"form.pushCount",addCountFlag:!0,newAccountSaved:!0},s={buildDate:"2018/04/27 12:45:00",livepeerid:f("#showRVideo-liveOutputModule").attr("data-livepeerid"),rId:f("#showRVideo-liveOutputModule").attr("data-id"),liveModule:"",ylWaitInterval:""},i={eventInit:function(){this.pushButton(),this.reauthCancel(),this.reauthCount(),this.showOrHidePlatfrom(),this.pushDetailBtn(),this.pushReauth(),this.pushReauthYizhibo(),this.selectEvent(),this.selectPlatfrom(),this.selectYouTube(),this.selectResolutionAndBitrate()},pushButton:function(){f(p.parentDom).on("click",p.pushBtnDom,function(){var a=f(this).parents("li");s.livepeerid=f("#showRVideo-liveOutputModule").attr("data-livepeerid"),s.rId=f("#showRVideo-liveOutputModule").attr("data-id").toLowerCase();var e=a.attr("data-nickName");if(f(this).hasClass("green-block-button")){var t={rId:s.rId,nickName:e};h.queryRtmpurl(t)}else{var i={CopierNickName:a.attr("data-nickName"),EncoderIndex:"1"},n={rid:s.rId,buildDate:s.buildDate,params:JSON.stringify([i]),nickNameArr:e,liveVideoId:s.livepeerid};if(l.ajaxReq("stopSoicalFileInfo.action",n,function(e){var t=e.errorCode;"0X0"==t||"0x0"==t?(a.find(".publish").html(m.i18n_publish),a.find(".publish").removeClass("red-block-button").addClass("green-block-button")):l.alertTips("i18n_stopShareFailed")}),"p"==a.attr("data-type")){var o=[];o.push(shareNickname),l.ajaxReq("stopPeriscopeBroadcast.action",{shareDetail:o})}}})},pushDetailBtn:function(){f(p.pushDetailDom).on("click",".pushDetailbtn",function(){var e=f(p.pushDetailDom),t=v._getDetailPushParam(e.attr("data-type"),e),a=f("#detailPush").find(".resolutionTypeList").attr("data-value"),i=f("#detailPush").find(".BitrateTypeList .dropdownDefault_value").text(),n=i.indexOf("b");if(i=i.slice(0,n),t.Resolution=a,t.VBitrate=i,"Y"==e.attr("data-type")&&null==e.find(".pushDetailbtn").attr("data-youtube"))return l.alertTips("i18n_producerReauthTitle",2e3),!1;if(f(p.pushDetailDom+" .pushDetailbtn").css("display","none"),f(p.pushDetailDom+" .loading").css("display","inline-block"),"block"!=f(p.pushDetailDom+" .yiLive-mobile").css("display"))h.saveRtmpDetailReq(t);else{var o=f("#detailPush .yiLive-mobile input").val(),s=f("#detailPush .yiLive-message input").val();h.saveYizhibo(o,s,t,h.saveRtmpDetailReq)}})},showOrHidePlatfrom:function(){f(p.parentDom).on("mouseenter",".pack-source-list",function(){f(this);return f(".share2Platform .select-live-platform").css("display","block"),!1}),f(p.ancestorparent).on("mouseleave",function(){return f(this).find(".select-live-platform").css("display","none"),!1})},reauthCount:function(){f(document.body).on("click",".reauthenticate .reauthen",function(){var e=(t=f(this).parents(".reauthenticate")).attr("data-nickName"),t=f(".select-live-platform .live-platform li[data-nickName='"+e+"']"),a={nickName:"",id:"",type:"",token:"",description:"",username:"",title:"",rtmpId:"",appId:"",refreshAccessToken:"",should_not_tweet:""};a=v._getAttrs(t,a),i.showReauth(a),f(".reauthenticate").remove()})},reauthCancel:function(){f(document.body).on("click",".reauthenticate .cancel",function(){f(".reauthenticate").remove()})},pushReauth:function(){f(p.pushCount).on("click",".panda-login .panda-auth-btn",function(){var e=f(this).parents(p.pushCount).attr("data-type");h.goReauth(e)}),f(p.pushCount).on("click",".popupContent_closeBtn,.cancel",function(){clearInterval(h.gePeriscopeTimer),clearInterval(h.getPandaAccountsTimer),clearInterval(h.getYouTubeTimer)})},selectEvent:function(){f(".popupContent_content").on("click",".InkePlay-checkbox",function(){var e=f(this);e.hasClass("active")?e.removeClass("active"):e.addClass("active")})},selectPlatfrom:function(){f(p.pushCount).on("keyup","input",function(){return!1}),f(".Push_toAccount_comment").on("click",".shareIcon",function(e){var t=f(this),a=t.children(".selectPosition").children(".dropdown_option_item");t.hasClass("bgGreen")||t.hasClass("bgRed")?(t.find(".icon-socialMeida").hasClass("active")?t.removeClass("bgRed"):t.removeClass("bgGreen"),a.removeClass("block"),0!=f(".Push_toAccount_comment").find(".bgGreen").length||f(".shareIcon").find(".icon-socialMeida").hasClass("active")||f(".push-live").removeClass("openLive")):(t.find(".icon-socialMeida").hasClass("active")?t.addClass("bgRed"):t.addClass("bgGreen"),a.addClass("block"),f(".push-live").addClass("openLive")),t.find(".icon-socialMeida").hasClass("active")||t.hasClass("bgRed")||f(e.target).hasClass("dropdown_option_item")||!t.hasClass("bgGreen")||(i.showDetailPush(t),a.hasClass("block")?(a.removeClass("block"),t.removeClass("bgGreen")):(a.addClass("block"),t.addClass("bgGreen"))),f(".shareIcon .icon-socialMeida.active").parent().find(".dropdown_option_item").hasClass("block")?f(".push-stop").removeClass("hide"):f(".push-stop").addClass("hide"),t.parent(".Push_toAccount_comment").find(".shareIcon").length!=f(".shareIcon .dropdown_option_item.block").length||t.hasClass("bgGreen")&&t.hasClass("bgRed")?t.parents(".pushing").find(".SelectAllBtn").children(".dropdown_option_item").removeClass("block selectAllBg"):t.parents(".pushing").find(".SelectAllBtn").children(".dropdown_option_item").addClass("block selectAllBg")})},selectResolutionAndBitrate:function(){f(".resolutionTypeList").createSimulateSelect([{name:"1080P/50i",type:"1920x1080"},{name:"720P",type:"1280x720"},{name:"540P",type:"960x540"},{name:"480P",type:"853x480"},{name:"360P",type:"640x360"},{name:"240P",type:"427x240"}],"","type","name");f(".BitrateTypeList").createSimulateSelect([{name:"12.0Mbps",type:"12.0"},{name:"2.5Mbps",type:"2.5"},{name:"1.5Mbps",type:"1.5"},{name:"750Kbps",type:"750"},{name:"400Kbps",type:"400"}],"","type","name")},showDetailPush:function(e){if(!(e.find(".detialPush").length<=0)){var t=e.attr("data-type"),a=u.getDetialPushInfo(t),i=v._getAccountInfo(t);f(".pushDetailbtn").val(m.i18n_publish),i=v._getAttrs(e,i);f(p.parentDom).find(".resolutionTypeList").attr("data-type");f("#detailPush .detail-info").html(a);var n=!0;if(""!=i.token?"S"!==t&&(i.token=u.getDAesString(i.token,u.pwd_2,u.iv_2),i.token=u.getDAesString(i.token,u.pwd_1,u.iv_1)):n=!1,v._setAttrs(f("#detailPush"),i),"F"==t){var o={title:m.i18n_privacy,radio:[{val:"EVERYONE",text:m.i18n_public},{val:"ALL_FRIENDS",text:m.i18n_friends},{val:"SELF",text:m.i18n_only_me}]},s={title:m.i18n_type,radio:[{val:"REGULAR",text:m.i18n_regular},{val:"AMBIENT",text:m.i18n_continuous}]};f("#shareTo").createSimulateSelect({radio:[{val:"Timeline"},{val:"Page"}]},c.getPageId,"val","text"),f("#privacy_active").createSelectedOptionList(o,null,"val","text"),f("#type_active").createSelectedOptionList(s,null,"val","text","",!0),c.checkPage()}if("Y"==t){f(".detail-info .others-website").removeClass("hide");f(p.pushDetailDom).find("#youtube-sourceTypeList").createSimulateSelect([{name:"YouTube",type:"Y"}],"","type","name"),f("#detailPush #youtube-sourceTypeList").find(".dropdownDefault").css("cursor","not-allowed")}if("O"==t||"Y"==t?f("#detailPush .push-title").addClass("hide"):f("#detailPush .push-title").removeClass("hide"),v._setPushCountInfo(f("#detailPush"),i),f("#detailPush").css("display","block"),f("#detailPush .panda-auth").css("display","none"),"Y"==t){var r={account:f("#detailPush .push-nickname").val()};l.ajaxReq("checkYoutueAuth",r,function(e){"0x0"!=e.errorCode?(f("#detailPush .panda-auth").css("display","block"),l.alertTips("i18n_producerReauthTitle",2e3)):f("#detailPush .pushDetailbtn").attr("data-youtube",!0)})}return n?"F"!=t&&"S"!=t&&"P"!=t||(f(p.pushCount+" .panda-auth").show(),f(p.pushCount+" .panda-login").hide(),f(p.pushCount+" .panda-nickname").show(),f(p.pushCount+" .panda-nickname input").val(i.username)):"F"!=t&&"S"!=t&&"P"!=t||(f(p.pushCount+" .panda-auth").show(),f(p.pushCount+" .panda-login").show(),f(p.pushCount+" .panda-nickname").hide(),f(p.pushCount+" .panda-nickname input").val("")),f(p.pushDetailDom+" .pushDetailbtn").css("display","inline-block"),f(p.pushDetailDom+" .loading").css("display","none"),!1}},selectYouTube:function(){f("#detailPush").on("click"," #youtube-sourceTypeList .dropdownDefault",function(){f("#detailPush").find("#youtube-sourceTypeList .dropdown_menu").css("display","none")}),f("#detailPush").on("click",".panda-auth-btn",function(){var e=f("#detailPush");h.queryYoutubeAuthor(e)})},pushReauthYizhibo:function(){f(p.pushCount).on("click",".yl-input-mobile a",function(){var e=f(this);i.getMesYizhibo(e)})},getMesYizhibo:function(e){var t=e;if(!t.hasClass("wait")){var a=t.prev().val();if(/^1[34578]\d{9}$/.test(a)){l.ajaxReq("sendSms.action",{mobile:a},function(e){"0x0"!=e.errorCode&&(-1!=e.errorInfo.indexOf("没有开播权限")?l.alertTips("i18n_ylNoPower"):-1!=e.errorInfo.indexOf("未注册用户")?l.alertTips("i18n_ylNoRegister"):-1!=e.errorInfo.indexOf("请求超限")?l.alertTips("i18n_ylRequestFrequently"):-1!=e.errorInfo.indexOf("禁止发起直播")?l.alertTips("i18n_accountBanned"):-1!=e.errorInfo.indexOf("24小时内发送短信")&&l.alertTips("i18n_messageTooMuch"))});var i=119;s.ylWaitInterval=setInterval(function(){var e=i+"s";t.addClass("wait").html(e),--i<0&&(clearInterval(s.ylWaitInterval),t.removeClass("wait").html(m.i18n_getMessgae))},1e3)}else l.alertTips("i18n_wrongPhoneNumber",2e3)}},showReauth:function(e){var t=e.nickName,a=["Facebook","YouTube",m.i18n_YiLive,m.i18n_Inke,m.i18n_pandaTV,"Periscope",m.i18n_Others];f("#addExtSource_sourceTypeList1").createSimulateSelect(a),showPopupBox(f("#editShareSource"),!0);var i=e.id,n=e.type,o=e.rtmpId,s=e.token,r=(v._getCopierType(e.type),e.description),d=e.username,c=e.title,l=e.appId,u=e.refreshAccessToken,p=e.should_not_tweet,h="1"===r?"active":"";switch(f("#editShareSource").find("#facebook_appKey").val(s),f("#addExtSource_sourceTypeList1").addClass("disabled"),f("#editShareSource").attr("data-sourceId",i),f("#addExtSource_sourceNames").val(t),f("#editShareSource").find(".nickName").attr("data-name",t),f(".eitItem").hide(),f("#editShareSource .yiLive-mobile a").removeClass("wait").html(m.i18n_getMessgae),resetCheckMessage(f("#editShareSource .yiLive-item .countdown")),n){case"F":f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title","facebook").html("Facebook"),f(".eit-fb-item").show(),l?(f(".eit_fb_oldversion").removeClass("hide"),f(".eit_fb_newversion").addClass("hide"),f("#eitVersion .selecet_option_item").eq(0).removeClass("active"),f("#eitVersion .selecet_option_item").eq(1).addClass("active"),f("#edit_appId").val(l),f("#edit_userId").val(o),f("#edit_token").val(s),f("#edit_eye_token").val(s)):(f(".eit_fb_newversion").removeClass("hide"),f(".eit_fb_oldversion").addClass("hide"),f("#eitVersion .selecet_option_item").eq(1).removeClass("active"),f("#eitVersion .selecet_option_item").eq(0).addClass("active"),d?(f(".eit-fb-item .eit-fb-login").addClass("hide"),f(".eit-fb-item .fb-nickname").removeClass("hide"),f(".eit-fb-item .fb-nickname input").val(d),f(".eit-fb-item .fb-nickname input").attr("user-id",o),f(".eit-fb-item .fb-nickname input").attr("access-token",s)):(f(".eit-fb-item .fb-nickname").addClass("hide"),f(".eit-fb-item .eit-fb-login").removeClass("hide")));break;case"Y":f(".eit-yt-item").show(),f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title","youtube").html("YouTube"),f("#sourceUrl").val(o),f("#sorce_token").val(s);break;case"I":f(".eit-inke-item").show(),f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title",m.i18n_Inke).html(m.i18n_Inke),f("#eitInkeId").val(o),f(".eitItem .InkePlay-checkbox").addClass(h);break;case"P":f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title",m.i18n_pandaTV).html(m.i18n_pandaTV),f(".eit-pandaTV-item").show(),f(".eit-pandaTV-item .panda-nickname input").val(d);break;case"Z":f(".eit-yl-item").show(),f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title",m.i18n_YiLive).html(m.i18n_YiLive),f("#editShareSource .yiLive-title input").val(c),f(".eitItem .InkePlay-checkbox").addClass(h),s?(f(".eit-yl-item .eit-yl-login").addClass("hide"),f(".eit-yl-item .yl-nickname").removeClass("hide"),f("#editShareSource .yiLive-account input").val(d).attr({readonly:!0,"data-token":s,"data-rtmpId":o})):(f(".eit-yl-item .yl-nickname").addClass("hide"),f(".eit-yl-item .eit-yl-login").removeClass("hide"));break;case"S":f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title","Periscope").html("Periscope"),f("#editShareSource .eit-periscope .popup_item_value").val(c),f("#editShareSource .eit-periscope .popup_item_value").attr("data-token",s),f("#editShareSource .eit-periscope .popup_item_value").attr("data-refreshaccesstoken",u),f("#editShareSource .eit-periscope .periscope-rauth").css("display","block"),f("#editShareSource .eit-periscope .panda-nickname input").val(d),"0"==p?f("#editShareSource .eit-periscope .InkePlay-checkbox").addClass("active"):f("#editShareSource .eit-periscope .InkePlay-checkbox").removeClass("active"),f(".eit-periscope").show();break;case"O":f(".eit-others-item").show(),f("#addExtSource_sourceTypeList1").find(".dropdownDefault_value").attr("title",m.i18n_Others).html(m.i18n_Others),f("#editShareSource .others-rtmp input").val(o),f(".eitItem .InkePlay-checkbox").addClass(h)}}},r={eventInit:function(){this.selPushPlatfrom(),this.saveCountbtn(),c.pushFaceBook()},selPushPlatfrom:function(){f(p.addExtSourceType).on("click",".dropdown_option",function(){var e=f(this).find("a").attr("data-value");f(this).parents("form").attr("data-type",e);-1!=["F","P","S","Y"].indexOf(e)?f(p.addExtSource+" .panda-auth").show():f(p.addExtSource+" .panda-auth").hide();var t=u.getDetialPushInfo(e);f(p.pushCount+" .panda-login").show(),f(p.pushCount+" .panda-nickname").hide(),f(p.addExtSource+" .detail-info").html(t)}),f(".pushing .addCount").on("click",function(){if(0!=p.addCountFlag){if(p.addCountFlag){p.addCountFlag=!1,(f(p.pushCount).find(".pushDetailbtn").attr("data-youtube")||f("#addShareSource").find(".add-count").attr("data-youtube"))&&(f(p.pushCount).find(".pushDetailbtn").removeAttr("data-youtube"),f("#addShareSource").find(".add-count").removeAttr("data-youtube")),f(p.pushCount).css("display","none");var e=[{name:"Facebook",type:"F"},{name:"Periscope",type:"S"},{name:m.i18n_YiLive,type:"Z"},{name:m.i18n_pandaTV,type:"P"},{name:"YouTube",type:"Y"},{name:m.i18n_Others,type:"O"}];f(p.addExtSourceType).createSimulateSelect(e,"","type","name"),f(p.addExtSourceType).parents("form").attr("data-type",f(p.addExtSourceType).attr("data-value")),f("#addShareSource").fadeIn(),f("#addShareSource .add-count").val(m.i18n_save),f("#addShareSource .push-nickname").val(""),f(p.pushCount).attr("data-refreshaccesstoken",""),f(p.pushCount).attr("data-data-token",""),f(p.pushCount+" .panda-auth").show(),f(p.pushCount+" .panda-login").show(),f(p.pushCount+" .panda-nickname").hide();var t=f(p.addExtSource).attr("data-type"),a=u.getDetialPushInfo(t);f(p.addExtSource+" .detail-info").html(a)}setTimeout(function(){p.addCountFlag=!0},300)}}),f(p.pushCount+" .cancel").on("click",function(){f(this).parents(p.pushCount).fadeOut()}),f(".pushing .deleteCount").on("click",function(){var a=f(".shareIcon .dropdown_option_item.block");return 0==a.length?(l.alertTips("i18n_hasChoose",2e3),!1):f(".shareIcon .icon-socialMeida.active").parent().find(".dropdown_option_item").hasClass("block")?(l.alertTips("i18n_pleaseStopToDel",2e3),!1):void l.confirmTips("i18n_producerproDeleteCount",function(){for(var e="",t=0;t<a.length;t++)e+=f(a[t]).parents(".shareIcon").attr("data-nickname")+",";e=e.substring(0,e.length-1),h.deleteCountReq(e)})})},saveCountbtn:function(){f("#addShareSource .add-count").on("click",function(){var e=f(this).parents("form"),t=e.attr("data-type"),a=v._getDetailPushParam(t,e);console.log(a);var i=r.saveCountTest(a);if("Z"==t&&i){var n=f("#addShareSource .yiLive-mobile input").val(),o=f("#addShareSource .yiLive-message input").val();h.saveYizhibo(n,o,a,h.saveCountReq)}else i&&h.saveCountReq(a)})},saveCountTest:function(e){if(!e.nickName)return l.alertTips("i18n_nickNameNoEmpty",2e3),!1;if(!/^.{1,32}$/.test(e.nickName))return l.alertTips("i18n_nikeNameLength1to32"),!1;if("null"===e.nickName.toLowerCase())return l.alertTips("i18n_IllegalOutputname"),!1;if(-1<e.nickName.indexOf(",")||-1<e.nickName.indexOf("%")||-1<e.nickName.indexOf("'"))return l.alertTips("i18n_OutputNameSupport"),!1;switch(e.type){case"S":if(!e.key||!e.refreshAccessToken)return l.alertTips("i18n_PeriscopeNoAuth",2e3),!1;break;case"F":if(!e.key)return l.alertTips("i18n_accessTokenNoEmpty",2e3),!1;break;case"O":if(!e.rtmpId)return l.alertTips("i18n_othersRtmp",2e3),!1;break;case"Y":f("#addShareSource").find(".add-count").attr("data-youtube")}return!0}},h={saveCountReq:function(t){f.ajax({type:"POST",url:"queryShareDetailByNickName",data:{nickName:t.nickName},timeout:7e3,success:function(e){"0x0"==(e=f.parseJSON(e)).errorCode?l.alertTips("i18n_nickNameExist",2e3):l.ajaxReq("saveRtmpDetail",t,function(e){"0x0"==e.errorCode&&(f("#addShareSource").fadeOut(),window.fn_getAllShareAccount())})}})},deleteCountReq:function(e){e={nickName:e},l.ajaxReq("deleteShareDetail",e,function(e){"0x0"==e.errorCode&&(f(p.pushCount).fadeOut(),window.fn_getAllShareAccount())})},saveRtmpDetailReq:function(a){l.ajaxReq("saveRtmpDetail",a,function(e){if("0x0"==e.errorCode){s.buildDate=s.buildDate,s.livepeerid=f(".main-preview").attr("data-livepeerid"),s.rId=f(".preview-content .preview-item[data-filename='Default']").attr("data-rid").toLowerCase();var t={rId:s.rId,nickName:a.nickName};"F"==a.type&&(t.destination=a.destination,t.pageId=a.pageId,t.pageAccessToken=a.pageAccessToken),h.queryRtmpurl(t)}})},getPandaAccountsTimer:"",gePeriscopeTimer:"",getYouTubeTimer:"",goReauth:function(e,t){switch(e){case"P":var a=(new Date).getTime()+"",i="https://open.panda.tv/oauth/authorize?client_id=tvu&redirect_uri=http://"+window.location.host+"/producerpro/outInterf?key="+a+"&_plat=pc_web&response_type=code&state=1FJCsFzBDAyyXsFtquwgv#",n=(window.outerWidth-800)/2+"px",o=window.open(i,"熊猫TV","width=800px,height=600px,menubar=no,top=200px,left="+n),s={key:a};h.getPandaAccountsTimer=setInterval(function(){l.ajaxReq("queryPandaInfo",s,function(e){e.errorInfo&&"Null record"==e.errorInfo||(clearInterval(h.getPandaAccountsTimer),o.close(),f(p.pushCount).attr("data-token",e.accessToken),f(p.pushCount).attr("data-username",e.nickName),f(p.pushCount+" .panda-login").hide(),f(p.pushCount+" .panda-nickname").show(),f(p.pushCount+" .panda-nickname input").val(e.nickName))})},1e3);break;case"S":a=(new Date).getTime()+"";var r="https://www.periscope.tv/oauth?client_id=P7mELQ3vvNzS3R2-6ZlcFy0IlyZtLrY_KqZizXvtMahAfELelp&redirect_uri=http://"+window.location.host+"/producerpro/getPeriscopeAccesstoken&state="+a,d=(n=(window.outerWidth-800)/2+"px",window.open(r,"periscope","width=800px,height=600px,menubar=no,top=200px,left="+n));s={state:a};h.gePeriscopeTimer=setInterval(function(){l.ajaxReq("getUserAccesstoken",s,function(e){if("0x0"==e.errorCode){clearInterval(h.gePeriscopeTimer),d.close();var t=JSON.parse(e.errorInfo);f(p.pushCount).attr("data-refreshaccesstoken",t[0].refresh_token),f(p.pushCount).attr("data-token",t[0].access_token),f(p.pushCount).attr("data-username",t[0].username),f(p.pushCount+" .panda-login").hide(),f(p.pushCount+" .panda-nickname").show(),f(p.pushCount+" .panda-nickname input").val(t[0].username)}})},1e3);break;case"F":if(!window.FB)return void l.alertTips("i18n_facebookBanned");FB.init({appId:"1780137928965295",xfbml:!0,version:"v2.0"}),FB.login(function(a){if(a&&!a.error_message&&"connected"==a.status){var i,e=a.authResponse.userID;f(p.pushCount).attr("data-rtmpid",e),FB.api("/me",function(e){i=e.name;var t=a.authResponse.accessToken;t=v.getAesString(t,v.pwd_1,v.iv_1),f.ajax({type:"POST",url:"getLongToken",data:{access_token:t},dataType:"json",async:!1,timeout:3e3,success:function(e){if("0x0"==e.errorCode){var t=e.errorInfo,a=f.parseJSON(t).access_token;f(p.pushCount).attr("data-token",a),f(p.pushCount).attr("data-username",i),f(p.pushCount+" .panda-login").hide(),f(p.pushCount+" .panda-nickname").show(),f(p.pushCount+" .panda-nickname input").val(i)}}})})}},{scope:"publish_actions,user_friends,publish_pages,manage_pages"});break;case"Y":var c=f("#addShareSource");h.queryYoutubeAuthor(c)}},queryYoutubeAuthor:function(e){var t;if(null!=(t="detailPush"==e.attr("id")?f("#detailPush").find(f(".push-nickname")).val():f("#addShareSource").find(f(".push-nickname")).val())&&""!=t){var a=(window.outerWidth-800)/2+"px",i=window.open("","Youtube","width=800px,height=600px,menubar=no,top=200px,left="+a),n={account:t};l.ajaxReq("getClientSecret",n,function(e){if("0x0"==e.errorCode){var t=e.errorInfo.redirectUrl;i.location.href=t}});var o={account:t};clearInterval(h.getYouTubeTimer),h.getYouTubeTimer=setInterval(function(){l.ajaxReq("checkYoutueAuth",o,function(e){if("0x0"==e.errorCode)return clearInterval(h.getYouTubeTimer),l.alertTips("i18n_youTuBeIsAuthorSuccess",2e3),f("#addShareSource").find(".add-count").attr("data-youtube",!0),f("#detailPush").find(".pushDetailbtn").attr("data-youtube",!0),void i.close()})},2e3)}else l.alertTips("i18n_nickNameNoEmpty",2e3)},queryRtmpurl:function(d){f.ajax({type:"POST",url:"getRtmpUrl",data:d,dataType:"json",async:!1,timeout:15e3,success:function(e){if("0x0"==e.errorCode)if("false"==(e=JSON.parse(e.errorInfo)[0]).valid){if("none"!=f("#detailPush").css("display")){var t=f("#detailPush").attr("data-type");return"Z"==t&&(f(p.pushDetailDom+" .yiLive-account").hide(),f(p.pushDetailDom+" .yiLive-mobile input").val(""),f(p.pushDetailDom+" .yiLive-message input").val(""),f(p.pushDetailDom+" .yiLive-mobile").show(),f(p.pushDetailDom+" .yiLive-message").show()),f(p.pushDetailDom+" .pushDetailbtn").css("display","inline-block"),f(p.pushDetailDom+" .loading").css("display","none"),f("#detailPush .panda-auth").css("display","block"),f("#detailPush .panda-auth .panda-login").css("display","block"),f("#detailPush .panda-auth .panda-nickname").css("display","none"),l.alertTips("i18n_reAuthenticate",1500),!1}u.reauthCount(),f(".reauthenticate").attr("data-nickName",d.nickName)}else{var a={};if(a.CopierNickName=e.nickName,a.EncoderIndex=1,a.RtmpUrl=e.rtmpUrl,a.CopierType=v._getCopierType(e.type),a.RetryTimes=10,a.LiveModule="social","F"==f("#detailPush").attr("data-type")){var i=e.liveVideoId,n=f("#positionInput").attr("data-id"),o=[],s=[];f.each(f(".friendList .friendTag"),function(e,t){var a=f(t).children().attr("data-id");o.push(a)}),f.each(f(".tagList .Tag"),function(e,t){var a=f(t).attr("data-id");s.push(a)});var r=f("#detailPush").attr("data-token");c.updateLiveVideo(i,n,o,s,r)}h.startSocial([a],i)}else"0x80100016"==e.errorCode?l.alertTips("i18n_cannotUseCloudR"):"0x80100014"==e.errorCode&&l.alertTips("i18n_youTuBeLiveIsAuthor")},error:function(e){console.log(e)}})},resetCheckMessage:function(e){clearInterval(h.checkMessageInterval),h.checkMessageInterval=null,h.checkMessageCountdown=30,e.html("").hide()},checkMessageInterval:"",saveYizhibo:function(e,t,a,i){if(/^1[34578]\d{9}$/.test(e))if(/^\d{4}$/.test(t)){var n=f(p.pushCount+" .yiLive-message .countdown");n.removeClass("hide"),l.ajaxReq("checkSms",{mobile:e,checkcode:t},function(e){if("0x0"==e.errorCode)a.rtmpId=e.memberid,a.key=e.accesstoken,a.username=e.nickname,a.avatar=e.avatar,i&&i(a);else if(n.show(),h.checkMessageInterval||(n.html("(30s)"),h.checkMessageInterval=setInterval(function(){h.checkMessageCountdown--;var e="("+h.checkMessageCountdown+"s)";n.html(e),h.checkMessageCountdown<0&&h.resetCheckMessage(n)},1e3)),-1!=e.errorInfo.indexOf("短信验证码"))l.alertTips("i18n_wrongMessageCode",3e3);else if(-1!=e.errorInfo.indexOf("请求超限")){var t="";t="zh"===f("#switchLanguage")[0].value?"请输入正确的短信验证码，"+h.checkMessageCountdown+"秒后重试":"Please input the correct message code, and try again after "+checkMessageCountdown+" secs.",l.alertTips(t,3e3)}})}else l.alertTips("i18n_messageCodeFour",2e3);else l.alertTips("i18n_wrongPhoneNumber",2e3)},startSocial:function(e,n){var o={rid:s.rId,share:["share"],params:JSON.stringify(e),buildDate:s.buildDate,encoderIndex:1,livePeerId:s.livePeerId,liveModule:s.liveModule};l.ajaxReq("startStudioFileInfo",o,function(e){if("0x0"==e.errorCode){var t=JSON.parse(o.params)[0],a={rId:o.rid,nickName:t.CopierNickName,encoderIndex:1,rtmpUrl:t.RtmpUrl,buildDate:s.buildDate,liveVideoId:n,liveModule:"social"},i={shareDetail:JSON.stringify(a)};f(p.pushDetailDom).hide(),h.saveShareDetail(i),f(p.pushDetailDom+" .pushDetailbtn").css("display","inline-block"),f(p.pushDetailDom+" .loading").css("display","none")}else l.alertTips(e.errorInfo)})},saveShareDetail:function(e){l.ajaxReq("saveShareDetail",e,function(e){console.log("saveShareDetail",e)})}},n={pushCurrentCountStateInfo:function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a].NickName);return t},setCurrentCountState:function(e){var t=n.pushCurrentCountStateInfo(e);f(".live-platform .publish").removeClass("red-block-button").addClass("green-block-button"),f(".live-platform .publish").html(m.i18n_publish);for(var a=0;a<t.length;a++)f(".live-platform [data-nickname='"+t[a]+"'] .publish").removeClass("green-block-button").addClass("red-block-button"),f(".live-platform [data-nickname='"+t[a]+"'] .publish").html(m.i18n_stop);0<t.length&&f(".share2Platform button.selectVideo-common").addClass("red-block-button").removeClass("green-block-button")}},v={pwd_1:"625202f9869e068d",iv_1:"5efd8f6060e20880",pwd_2:"1020304050607080",iv_2:"a1b2c3d4e5f6g7h8",getAesString:function(e,t,a){var i=o.enc.Utf8.parse(e);t=o.enc.Utf8.parse(t),a=o.enc.Utf8.parse(a);var n=o.AES.encrypt(i,t,{iv:a,mode:o.mode.CBC,padding:o.pad.Iso10126});return o.enc.Base64.stringify(n.ciphertext)},getDAesString:function(e,t,a){t=o.enc.Utf8.parse(t),a=o.enc.Utf8.parse(a);return o.AES.decrypt(e,t,{iv:a,mode:o.mode.CBC,padding:o.pad.Iso10126}).toString(o.enc.Utf8)},_setPushCountInfo:function(e,t){switch(e.find(".push-nickname").val(e.attr("data-nickname")),t.type){case"S":e.find(".push-title input").val(e.attr("data-title")),"1"==e.attr("data-should_not_tweet")?e.find(".select-twitter .InkePlay-checkbox").removeClass("active"):e.find(".select-twitter .InkePlay-checkbox").addClass("active");break;case"P":e.find(".panda-nickname input").val(e.attr("data-username"));break;case"Y":e.find(".addExtSource_sourceUrl input").val(e.attr("data-rtmpid")),e.find(".addExtSource_sourceUrl input").val(e.attr("data-rtmpid")),e.find(".addKey input").val(e.attr("data-token")),e.find(".addKey input").val(e.attr("data-token"));break;case"I":e="Inke";break;case"Z":e.find(".yl-nickname input").val(e.attr("data-username")),e.find(".push-title input").val(e.attr("data-title")),"0"==e.attr("data-description")?e.find(".InkePlay-checkbox").removeClass("active"):e.find(".InkePlay-checkbox").addClass("active");break;case"O":e.find(".others-rtmp input").val(e.attr("data-rtmpid"))}},_getCopierType:function(e){var t="";switch(e){case"F":t="Facebook";break;case"S":t="Periscope";break;case"P":t="PandaTV";break;case"Y":t="Youtube";break;case"I":t="Inke";break;case"Z":t="Yi Live";break;case"O":t="Others"}return t},_getAccountInfo:function(e){var t={};switch(e){case"F":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:"",title:"",appId:""};break;case"S":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:"",title:"",appId:"",should_not_tweet:"",refreshAccessToken:"",isNew:""};break;case"P":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:""};break;case"Y":t={id:"",rtmpId:"",token:"",type:"",nickName:""};break;case"I":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:""};break;case"Z":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:"",title:""};break;case"O":t={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:""}}return t},_getDetailPushParam:function(e,t){var a;switch(e){case"F":a={id:t.attr("data-id"),username:t.attr("data-username"),userId:t.attr("data-rtmpid"),nickName:t.find(".push-nickname").val(),title:t.find(".push-title input").val(),description:t.find(".description").val(),privacy:f("#privacy_active").attr("data-value"),streamType:f("#type_active").attr("data-value"),type:"F",rtmpId:t.attr("data-rtmpid"),destination:"Page"==f("#shareTo").attr("data-value")?"Pages":f("#shareTo").attr("data-value"),pageId:f("#shareTo").attr("pageid"),pageAccessToken:f("#shareTo").attr("pagetoken")},t.attr("data-token")?a.key=v.getAesString(t.attr("data-token"),v.pwd_1,v.iv_1):a.key=void 0;break;case"S":a={id:t.attr("data-id"),rtmpId:t.attr("data-rtmpid"),key:t.attr("data-token"),type:"S",nickName:t.find(".push-nickname").val(),username:t.attr("data-username"),description:t.attr("data-description"),title:t.find(".push-title input").val(),appId:t.attr("data-appid"),should_not_tweet:t.find(" .select-twitter .InkePlay-checkbox").hasClass("active")?0:1,refreshAccessToken:t.attr("data-refreshaccesstoken"),isNew:"0"};break;case"P":a={id:t.attr("data-id"),rtmpId:"",key:v.getAesString(t.attr("data-token"),v.pwd_1,v.iv_1),type:"P",nickName:t.find(".push-nickname").val(),username:t.attr("data-username")};break;case"Y":a={id:t.attr("data-id"),type:"Y",nickName:t.find(".push-nickname").val(),isAuto:0};break;case"I":a={id:"",rtmpId:"",token:"",type:"",nickName:"",username:"",description:""};break;case"Z":a={id:t.attr("data-id"),rtmpId:t.attr("data-rtmpid"),key:v.getAesString(t.attr("data-token"),v.pwd_1,v.iv_1),type:"Z",nickName:t.find(".push-nickname").val(),username:t.find(".yl-nickname input").val(),description:t.find(".InkePlay-checkbox").hasClass("active")?1:0,title:t.find(".push-title input").val()};break;case"O":a={id:t.attr("data-id"),rtmpId:t.find(".others-rtmp input").val(),key:v.getAesString(t.attr("data-token"),v.pwd_1,v.iv_1),type:"O",nickName:t.find(".push-nickname").val(),title:t.find(".push-title input").val(),username:"",description:""}}return a},_getAttrs:function(e,t){for(var a in t)t[a]=e.attr("data-"+a);return t},_setAttrs:function(e,t){for(var a in t)e.attr("data-"+a,t[a])}};return i.eventInit(),r.eventInit(),u.setCurrentCountState=n.setCurrentCountState,u.goReauth=h.goReauth,u.getMesYizhibo=i.getMesYizhibo,u.pwd_1=v.pwd_1,u.iv_1=v.iv_1,u.iv_2=v.iv_2,u.pwd_2=v.pwd_2,u.getDAesString=v.getDAesString,u.getAesString=v.getAesString,u}($,oUtils,switchLangObj,CryptoJS,facebookpushapi,window.pushAbout||{}),resourceAbout=function(l,u,r){var e={initEvent:function(){this.ipEvent()},ipEvent:function(){l(".ip-add").on("click",function(){if(10<=l(".ip-body .ip-info").length)return u.alertTips("i18n_OnlySupport10Ext"),!1;var e='<div class="ip-info clearFix"><div class="ip-address left"><input type="text"  placeholder="http/rtmp/issp"></div><div class="left select"></div><div class="ip-operate left">'+r.i18n_ipConnect+'</div><div class="ip-del left"><i class="iconfont icon-del"></i></div></div>';l(".ip-body").prepend(e);l(".preview-content .preview-item");l(".ip-body .select").eq(0).createSimulateSelect([{name:1,type:"R"},{name:2,type:"R"},{name:3,type:"R"},{name:4,type:"R"},{name:5,type:"ip"}],"","type","name"),l(".ip-body .select").eq(0).attr("data-value","no_select"),l(".ip-body .select .dropdownDefault_value").eq(0).html(r.i18n_Unspecified),l(".ip-body .select .dropdownDefault_value").eq(0).attr("title",r.i18n_Unspecified)}),l(".ip-body").on("click",".ip-operate",function(){var e=l(this).parents(".ip-info");if("no_select"==e.find(".select").attr("data-value"))return u.alertTips("i18n_pleaseChooseCamera",1500),!1;var t=l(this).parent(),a=e.find("input").val();null==e.attr("data-filename")&&e.attr("data-filename",a);var i=t.find("input").eq(0).val();i=i.trim(),t.attr("data-id")?n(e,i):p.addrStreamAddress(i,e)}),l(".ip-body").on("click",".ip-del",function(){var e=l(this).parent();e.attr("data-id")?p.deleteAddress(e):e.remove()})}},p={addExternalSource:function(e,t,a){var i={url:e,rid:t};u.ajaxReq("addExtAndSynchronize",i,function(e){"0x0"==e.errorCode?(p.reqNum=0,a.attr("data-livePeerid",e.result.peerId),p.startRAndExtLive(i.rid,e.result.peerId)):"0x80100017"==e.errorCode?u.alertTips("i18n_hasAddedUrl",1500):u.alertTips(e.errorInfo,1500)})},reqNum:0,startRAndExtLive:function(t,a){var e={};e.TIdHex=a;var i={rid:t.toLowerCase(),params:JSON.stringify(e)};u.ajaxReq("startLive",i,function(e){"0"==e.ErrorCode?(p.reqNum=0,u.alertTips("i18n_producerProUploadIpSourceTip",1500)):5<p.reqNum?(p.reqNum=0,u.alertTips("start live fail",1500)):(p.reqNum++,p.startRAndExtLive(t,a))})},deleteAddress:function(a){var e="",t="";0!=window.sourceList.uploadIpShimArr.length&&(e=window.sourceList.uploadIpShimArr[0].PreviewShm.SharedMemoryName,t=window.sourceList.uploadIpShimArr[0].PreviewShm.FileName);var i=a.attr("data-livepeerid"),n=a.find("input").val().trim()==t,o=!1,s=l(".preview-content .preview-item.outPutActive");if((s.attr("data-filename")==e&&n||s.attr("data-rlivepeerid")==i)&&(o=!0),!o){if(l(".afv-cut .radius-box").hasClass("close")){var r=l(".afv-audio-cut .afv-audio").html().substring(6),d=l(".preview-content .preview-item").eq(r-1);(d.attr("data-filename")==e&&n||d.attr("data-rlivepeerid")==i)&&(o=!0)}var c=l(".preview-content .preview-item.pipOutputActive");0!=c.length&&(c.attr("data-filename")==e&&n||c.attr("data-rlivepeerid")==i)&&(o=!0)}if(o)return u.alertTips("i18n_dontDeleteVideoAtUsing"),!1;u.confirmTips("i18n_producerProdeleteVideoConfirm",function(){var e={id:a.attr("data-id")};if(u.ajaxReq("studio_delete_stream",e,function(e){"0x0"==e.errorCode?a.remove():u.alertTips(e.errorInfo,1500)}),window.peerClientStatusArr.ipsourceFileName==a.find("input").val().trim()){var t=window.sourceList.uploadIpShimArr[0].PreviewShm.SharedMemoryName;p.delIpsource(a,t)}})},delIpsource:function(a,e,i){var n=window.sourceList.uploadIpShimArr[0].PreviewID,t={rid:l(".main-rList .rList-show").attr("data-peerId"),params:JSON.stringify([{FileShimeName:e}])};u.ajaxReq("removeFileShim",t,function(e){if("0x0"==e.errorCode){-1<a.attr("data-filename").indexOf("(IP Shim)")&&a.remove(),void 0!==n&&on_leave(n);var t=a.find(".ip-address input").val();i&&p.addIPSourceInProducer(t)}else u.alertTips(e.errorInfo,1500)})},addIPSourceInProducer:function(e){if(!i(e))return u.alertTips("i18n_producerProIsNotUrl",1500),!1;var t={rid:l(".main-rList .rList-show").attr("data-peerId")},a={FileShimeName:e,NickName:(new Date).getTime().toString()+" (IP Shim)",ShimType:200};t.params=JSON.stringify(a),u.ajaxReq("addIPSourceInProducer",t,function(e){"0x0"==e.errorCode?u.alertTips("i18n_producerProUploadIpSourceTip",1500):u.alertTips(e.errorInfo,1500)})},addrStreamAddress:function(t,a){if(!i(t))return u.alertTips("i18n_producerProIsNotUrl",1500),!1;var e={pathUrl:t,streamType:1};u.ajaxReq("studio_store_stream",e,function(e){"0x0"==e.errorCode?(a.attr("data-id",e.result.id),a.find(".ip-del").removeClass("disabled"),n(a,t)):u.alertTips(e.errorInfo,1500)})},delIpsourceAndCreate:function(e,t){var a=window.sourceList.uploadIpShimArr[0].PreviewShm.SharedMemoryName,i=!1;if(!(i=l(".main-output").attr("data-filename")==a)){if(l(".afv-cut .radius-box").hasClass("close")){var n=l(".afv-audio-cut .afv-audio").html().substring(6);l(".preview-content .preview-item").eq(n-1).attr("data-filename")==a&&(i=!0)}0!==l(".preview-content .preview-item.pipOutputActive").length&&l(".preview-content .preview-item.pipOutputActive").attr("data-filename")==a&&(i=!0)}if(i)return u.alertTips("i18n_dontDeleteVideoAtUsing"),!1;u.confirmTips("i18n_producerProdeleteVideoConfirm",function(){p.delIpsource(t,a,!0)})},getIpStreamList:function(){u.ajaxReq("studio_list_stream",{streamType:1},function(e){"0x0"==e.errorCode?function(e){for(var t="",a=0;a<e.length;a++){var i=e[a].pathUrl,n=i.lastIndexOf("\\"),o=(i.substring(n+1),i.lastIndexOf(".")),s=i.indexOf("(ip Shim)");i.substring(o+1),i.substring(n+1,o),i.substring(n+1,s);t+='<div class="ip-info clearFix" data-filename="'+i+'" data-id="'+e[a].id+'" data-livepeerid="'+e[a].peerId+'"><div class="ip-address left"><input type="text"  placeholder="rtmp/http/issp" value="'+e[a].pathUrl+'"></div><div class="left select"></div><div class="ip-operate left">'+r.i18n_ipConnect+'</div><div class="ip-del left"><i class="iconfont icon-del"></i></div></div>'}l(".ip-body").html(t);l(".ip-body .select").createSimulateSelect([{name:1,type:"R"},{name:2,type:"R"},{name:3,type:"R"},{name:4,type:"R"},{name:5,type:"ip"}],"","type","name"),l(".ip-info .ip-address input").css("width","368px"),l(".ip-body .select").attr("data-value","no_select"),l(".ip-body .select .dropdownDefault_value").html(r.i18n_Unspecified),l(".ip-body .select .dropdownDefault_value").attr("title",r.i18n_Unspecified)}(e.result):u.alertTips(e.errorInfo,1500)})}};function n(e,t){var a=e.find(".select").attr("data-value"),i=e.find(".dropdownDefault_value").html(),n=l(".preview-content .preview-item").eq(i-1);if("R"==a){var o=n.attr("data-rid");p.addExternalSource(t,o,e)}else 0!==window.sourceList.uploadIpShimArr.length?p.delIpsourceAndCreate(n,e):p.addIPSourceInProducer(t)}function i(e){return!!new RegExp("^((https|http|ftp|rtmp|rtsp|hls|udp|issp|mhttp)?://)+(([0-9a-zA-Z_!~*'().&=+$%-]+: )?[0-9a-zA-Z_!~*'().&=+$%-]+@)?(([0-9]{1,3}.){3}[0-9]{1,3}|([0-9a-zA-Z_!~*'()-]+.)*([0-9a-zA-Z][0-9a-zA-Z-]{0,61})?[0-9a-zA-Z].[a-zA-Z]{2,6})(:[0-9]{1,5})?((/?)|(/[0-9a-zA-Z_!~*'().;?:@&=+$,%#-]+)+/?)$").test(e)}return e.initEvent(),{getIpStreamList:p.getIpStreamList}}($,oUtils,switchLangObj);