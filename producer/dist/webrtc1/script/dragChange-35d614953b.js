"use strict";var correctDrag=function(D,e,n,C){function s(e){return(e=Math.round(e))%2==1&&e++,e}function I(){var e=window.innerWidth*(100/1920);D("html").css("font-size",e+"px");for(var t=D(".big-video"),i=0;i<t.length;i++){var r=t.eq(i);r.css("height",Math.random(9*r.width()/16)+"px")}!function(){var e=document.documentElement.clientHeight||document.body.clientHeight,t=document.documentElement.clientWidth||document.body.clientWidth,i=D(".big-video");if(e/t<9/16&&766<e&&e<1080){var r=D("header").height(),o=D(".sd-preview-list").height(),p=D(".sd-pretreat").height(),a=D(".overlay-tab").height(),s=D(".preview-top").height(),n=r+o+p+a+s;n=e-n-5;var d=D(".main-center").width(),v=((t-d)/2-16/9*n)/2;D(".sd-main .main-preview .inner").css("padding","0 "+v+"px"),D(".sd-main .main-output .inner").css("padding","0 "+v+"px");for(var c=0;c<i.length;c++){var g=i.eq(c);g.css("height",n+"px")}}else{D(".sd-main .main-preview .inner").removeAttr("style"),D(".sd-main .main-output .inner").removeAttr("style"),D(".sd-main .main-preview .inner").css("padding-left","10px"),D(".sd-main .main-output .inner").css("padding-right","10px");for(var c=0;c<i.length;c++){var g=i.eq(c);g.css("height",9*g.width()/16+"px")}}if(800<D(".main-preview .big-video").width())D(".main-center").css("margin-top","none"),D(".sd-main .audio").removeAttr("style"),D(".sd-main .audio .row .back").removeAttr("style"),D(".sd-main .audio .row .bg").removeAttr("style");else{var h=D(".main-preview .big-video").height();D(".sd-main .audio").css("height",.8*h+"px"),D(".sd-main .audio .row .back").css("height",.8*h+"px"),D(".sd-main .audio .row .bg").css("height",.8*h+"px"),D(".main-center").css("margin-top","10px")}500<D(".main-preview .big-video").width()?(D(".main-preview .preview-title").css("display","block"),D(".output-top .output-title").css("display","block")):(D(".main-preview .preview-title").css("display","none"),D(".output-top .output-title").css("display","none"))}()}return I(),{textBlur:function(e){var t=e.scaleClassName,i=D(".DragAndDrop "+t),r=D(t).css("transform");if("none"!=r){r=r.substring(7,r.indexOf(","));var o=parseInt(i.css("font-size"))*r;12<o?i.css({transform:"scale(1)","font-size":o+"px"}):(r=o/12,i.css({transform:"scale("+r+")","font-size":o+"px"}))}var p=overlayCut.subtitleCom();p.style=JSON.stringify(p.style),p.id=p.textId,p.checked=1,n.textInit(p,!0),D("#preview .textDiv").css({width:i.width()+"px",height:i.height()+"px"})},correctLogo:function(e){var t=e.target,i=(e.rate,{}),r=D(t).width(),o=(D(t).height(),D(t).position().left),p=D(t).position().top,a=D("#preview").width()-o-r;i.logoXOffset=C.getOutputWidth("#preview",a),i.logoYOffset=C.getOutputHeight("#preview",p),i.imageWidth=C.getOutputWidth("#preview",r),i.imageHeight=Math.round(i.imageWidth*e.rate),i.id=D(t).attr("data-id"),i.logoXOffset=s(i.logoXOffset),i.logoYOffset=s(i.logoYOffset),i.imageWidth=s(i.imageWidth),i.imageHeight=Math.round(i.imageWidth*e.rate),D(t).css({width:C.getPriviewWidth("#preview",null,i.imageWidth)+"px",height:C.getPriviewWidth("#preview",null,i.imageWidth*e.rate)+"px",top:C.getPriviewHeight("#preview",null,i.logoYOffset)+"px"}),D(t).css({left:C.getPriviewWidth("#preview",null,C.resolutionW-i.logoXOffset-i.imageWidth)+"px"}),i.url=D(t).attr("data-url"),i.zorder=D(t).css("z-index"),i.checkedStatus=1,n.logoInit(i,!0)},correctPip:function(e){var t=e.target,i={},r=D(t).width(),o=D(t).position().left,p=D(t).position().top,a=D("#preview").width()-o-r;a=C.getOutputWidth("#preview",a),r=C.getOutputHeight("#preview",r),p=C.getOutputWidth("#preview",p),(i={}).pipXOffset=s(a),i.pipWidth=s(r),i.pipYOffset=s(p),i.pipHeight=Math.round(i.pipWidth*(9/16)),i.id=D(".pretreat-content .pip").attr("data-id"),i.pipAudioSharedMemoryName=D(".pretreat-content .pip").attr("data-pipaudiosharedmemoryname"),i.pipVideoSharedMemoryName=D(".pretreat-content .pip").attr("data-pipvideosharedmemoryname"),i.zorder=D("#preview .pip").css("z-index"),i.checkedStatus=1,console.log(i),n.pipInit(i)},dragCorrectPositionAndSize:function(){I(),document.body.clientWidth;var e=D(".main-preview .preview-source").width()/C.resolutionW;816<D("#preview").width()&&D(".score-pattern ul").css("left","0");var t=D(".pretreat-content .pretreat-item-score.check");if(0!==t.length){var i=t.attr("data-params");if(i=decodeURIComponent(i),null==(i=JSON.parse(i)).imageWidth){var r=i.size.split("x");i.imageWidth=r[0],i.imageHeight=r[1]}var o=C.getPriviewWidth("#preview",null,i.imageWidth),p=C.getPriviewHeight("#preview",null,i.imageHeight),a=C.getPriviewWidth("#preview",null,i.logoXOffset),s=C.getPriviewHeight("#preview",null,i.logoYOffset),n=D("#preview").width()-a-o;i.imageWidth,D(".scoreDiv .score-scale").css("transform","scale("+e+")");var d=D("#preview .scoreDiv").css("z-index");D(".scoreDiv").removeAttr("style"),D(".scoreDiv").css({position:"absolute",width:o+"px",height:p+"px",left:n+"px",top:s+"px","z-index":d})}var v=D(".pretreat-content .logo.check");if(0!==v.length&&D.each(v,function(e,t){var i=D(t).attr("data-params");i=JSON.parse(decodeURIComponent(i)),overToPreview.logoInit(i)}),0!=D(".output-source .big-video .logo-box").length)for(var c,g=D(".output-source .big-video .logo-box"),h=0;h<g.length;h++)g.eq(h).hasClass("scoreDiv")||(c=g.eq(h).attr("data-params"),c=JSON.parse(decodeURIComponent(c)),overToPreview.logoInit(c,".output-source .big-video"));if(0!==(l=D(".pretreat-content .pretreat-item-text.check")).length){i=l.attr("data-params"),i=decodeURIComponent(i),i=JSON.parse(i),a=C.getPriviewWidth("#preview",null,i.xOffset),s=C.getPriviewHeight("#preview",null,i.yOffset);var l,u=JSON.parse(i.style),w=C.getPriviewHeight("#preview",null,u.fontSize),m=u.backgroundColor.slice(2,8),f=u.backgroundColor.slice(0,2),x=HexToRgba(m,f),b=u.foregroundColor.slice(2,8);d=(l=D("#preview .textDiv")).css("z-index"),D("#preview .textDiv").removeAttr("style"),D("#preview .textDiv").css({position:"absolute",right:a+"px",top:s+"px"}),D("#preview .textDiv .preTextarea").css("font-size",w+"px");var O=D("#preview").width()-a-D("#preview .textDiv").width();l.removeAttr("style"),l.css({position:"absolute",left:O+"px",top:s+"px","z-index":d}),D("#preview .textDiv").css("background-color",x),D("#preview .textDiv .preTextarea").css("color","#"+b)}if(0!=D("#preview .pip").length){i={pipXOffset:"",pipYOffset:"",pipWidth:"",pipHeight:""},i=getAttrs(D(".pretreat-content .pip"),i);var W=C.getPriviewWidth("#preview",null,i.pipWidth),y=C.getPriviewHeight("#preview",null,i.pipHeight);a=C.getPriviewWidth("#preview",null,i.pipXOffset),s=C.getPriviewHeight("#preview",null,i.pipYOffset),d=D("#preview .pip").css("z-index"),D("#preview .pip").removeAttr("style"),D("#preview .pip").css({width:W+"px",height:y+"px",right:a+"px",top:s+"px","z-index":d})}if(0!=D(".output-source .big-video .pip").length){var k=".output-source .big-video";i={pipXOffset:D(".output-source .big-video .pip").attr("data-pipxoffset"),pipYOffset:D(".output-source .big-video .pip").attr("data-pipYOffset"),pipWidth:D(".output-source .big-video .pip").attr("data-pipWidth"),pipHeight:D(".output-source .big-video .pip").attr("data-pipHeight")},W=C.getPriviewWidth(k,null,i.pipWidth),y=C.getPriviewHeight(k,null,i.pipHeight),a=C.getPriviewWidth(k,null,i.pipXOffset),s=C.getPriviewHeight(k,null,i.pipYOffset),d=D(".output-source .big-video .pip").css("z-index"),D(".output-source .big-video .pip").removeAttr("style"),D(".output-source .big-video .pip").css({width:W+"px",height:y+"px",right:a+"px",top:s+"px","z-index":d})}var H=D(".pretreat-content .pretreat-item-clock.clock");if(0!=H.length){var P=H.attr("data-params");P=JSON.parse(decodeURIComponent(P)),overToPreview.clockInit(P)}0!=D(".output-source .big-video .clockDiv").length&&(P=D(".output-source .big-video .clockDiv").attr("data-params"),P=JSON.parse(decodeURIComponent(P)),overToPreview.clockInit(P,".output-source .big-video"));if(0!=D(".output-source .big-video .textDiv").length){var z=D(".output-source .big-video .textDiv").attr("data-params");z=JSON.parse(decodeURIComponent(z)),overToPreview.textInit(z,".output-source .big-video")}},correctClock:function(e){var t=e.target,i={},r=D(t).width(),o=(D(t).height(),D(t).position().left),p=D(t).position().top,a=D("#preview").width()-o-r;i.xOffset=C.getOutputWidth("#preview",a),i.yOffset=C.getOutputHeight("#preview",p),i.id=D(t).attr("data-id"),i.imageWidth=C.getOutputWidth("#preview",r),i.id=D(t).attr("data-id"),i.zorder=1e3,i.operation=D(t).attr("data-operation"),i.height="60",i.width="144",i.checked="1","create"!==D(".clockDiv").attr("data-operation")&&D(".clockDiv").attr("data-operation","clockCut");var s={fontName:"Arial",fontSize:46,foregroundColor:"FFFFFFFF",text:D(".clockTextarea").html()};i.style=s,n.clockInit(i,!0)}}}($,oUtils,overlying,widthAndHeight);